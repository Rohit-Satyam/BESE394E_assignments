## Week1 Assignment

- Compare “Results from JCI Insight” vs “Results derived from your own analysis”
- Identify a data-set related to Monocytes in bulk RNA-seq and run the complete pipeline. Generate a report. (See Week2 directory)
- Prepare an organized pipeline for RNA-seq.
	- Power point explaining the pipeline.
	- Example with R.

- **Extra mile:** *Process the fastq to count table from one of the three data sets. Re-do the analysis and generate a report:*
	- *Code*
	- *Outcomes of the analysis.*

## Response

The Raw FASTQ file for JCI paper titled "Functional reprogramming of monocytes in patients with acute and convalescent severe COVID-19" was downloaded using `fasterq-dump` and `pysradb`

```
## First convert your GSE ID to SRP and then use it to get SRR ID of the entire project
## pip install git+https://github.com/saketkc/pysradb
pysradb gse-to-srp  GSE198257
pysradb srp-to-srr SRP178139 > meta.tsv

## now choose the SRR IDs you wanna download from meta.tsv and save them as srr.txt
## The use fasterq-dump and GNU-parallel
cat srr.txt | parallel -j 5 "fasterq-dump -e 20 --skip-technical --split-3 -p {}"
```

Once the files were downloaded, the PE reads were aligned against `GRCh38 v45` (GRCh38.primary_assembly.genome.fa) obtained from GENCODE. The nextflow pipeline, RNAgrinder, that was developed for in-house health assessment of RNASeq samples was executed on KAUST IBEX and count matrices generated by STAR. An examplary command is given below

```
nextflow run main.nf --input '/ibex/scratch/projects/c2077/rohit/coursework2024/jcpaper/data/SRR18280853*_{1,2}.fastq.gz' \
--outdir /ibex/scratch/projects/c2077/rohit/coursework2024/jcpaper/results \
--ref /ibex/scratch/projects/c2077/rohit/coursework2024/study_monocyte/RNAgrinder/resources/GRCh38.primary_assembly.genome.fa \
--gtf /ibex/scratch/projects/c2077/rohit/coursework2024/study_monocyte/RNAgrinder/resources/gencode.v45.primary_assembly.annotation.gtf \
--mode PE --rrnaUse ribodetector --index_dir /ibex/scratch/projects/c2077/rohit/coursework2024/study_monocyte/RNAgrinder/resources/00_index/ \
--skipKraken=true -w SRR18280853_work --cpus=120
```

|    | Samples     | Total Reads | Survied post Trimming | Read loss(%)     | rRNA    | rRNA (%)         | non-rRNA reads | non-rRNA (%)     | Total Mapped(%)  | Unique Mapped Reads | Unique Mapped Rate | No. of Genes Detected | rRNA Rate (Post Alignment) | Duplicate (%) | Duplicate Reads |
| -- | ----------- | ----------- | --------------------- | ---------------- | ------- | ---------------- | -------------- | ---------------- | ---------------- | ------------------- | ------------------ | --------------------- | -------------------------- | ------------- | --------------- |
| 1  | SRR18280823 | 14574244    | 13211535              | 9.35011792035319 | 3524169 | 24.1808014192709 | 9687366        | 66.4690806603759 | 97.1524251277385 | 8726865             | 90.09              | 15158                 | 1.8435                     | 31.8801       | 3077728         |
| 2  | SRR18280824 | 16785693    | 15293416              | 8.89017212455869 | 3911956 | 23.305299340337  | 11381460       | 67.8045285351043 | 96.8744607458094 | 10233112            | 89.91              | 15543                 | 1.8814                     | 32.9844       | 3745692         |
| 3  | SRR18280825 | 27184770    | 25394676              | 6.58491500939681 | 4770547 | 17.5486016618864 | 20624129       | 75.8664833287168 | 97.1359760210965 | 18959397            | 91.93              | 17231                 | 2.1791                     | 36.2988       | 7449593         |
| 4  | SRR18280826 | 31783953    | 29548706              | 7.03262743938742 | 3254683 | 10.2400195469708 | 26294023       | 82.7273530136418 | 97.5127199059649 | 24234524            | 92.17              | 18453                 | 1.37518                    | 24.7517       | 6500214         |
| 5  | SRR18280827 | 26827517    | 24903881              | 7.17038405007813 | 3417891 | 12.7402435342786 | 21485990       | 80.0893724156432 | 97.8956659665205 | 19826800            | 92.28              | 18019                 | 1.29779                    | 25.0413       | 5365604         |
| 6  | SRR18280828 | 19146536    | 17700194              | 7.55406617677474 | 2092021 | 10.9263680908129 | 15608173       | 81.5195657324124 | 97.3307125696262 | 14413391            | 92.35              | 17285                 | 0.835773                   | 19.8144       | 3095064         |
| 7  | SRR18280829 | 18463313    | 16918600              | 8.36639123216944 | 4162184 | 22.5429964817257 | 12756416       | 69.0906122861049 | 97.6229843868372 | 11680788            | 91.57              | 15901                 | 1.97148                    | 29.253        | 3729594         |
| 8  | SRR18280830 | 31267151    | 29073178              | 7.01686252130871 | 2215470 | 7.08561518764533 | 26857708       | 85.897522291046  | 97.1616714278076 | 24590829            | 91.56              | 17893                 | 1.27021                    | 33.1471       | 8864008         |
| 9  | SRR18280831 | 17494852    | 16042190              | 8.30336832800872 | 3599951 | 20.577201796277  | 12442239       | 71.1194298757143 | 96.8226217162361 | 11201860            | 90.03              | 16203                 | 2.39767                    | 30.1393       | 3729452         |
| 10 | SRR18280832 | 19967907    | 18268327              | 8.51155807165969 | 3911859 | 19.5907312669275 | 14356468       | 71.8977106614128 | 97.7596718078569 | 13238126            | 92.21              | 17475                 | 0.917595                   | 24.5965       | 3528680         |
| 11 | SRR18280833 | 24267182    | 22478462              | 7.37094236982275 | 3007816 | 12.394582939214  | 19470646       | 80.2344746909633 | 97.7537006219516 | 18127017            | 93.1               | 17647                 | 0.896557                   | 24.1778       | 4714038         |
| 12 | SRR18280834 | 29090763    | 26716431              | 8.16180723757572 | 3445518 | 11.8440276042261 | 23270913       | 79.9941651581982 | 97.7270767158985 | 21329882            | 91.66              | 11185                 | 0.649062                   | 88.9065       | 20476726        |
| 13 | SRR18280835 | 39655770    | 36157884              | 8.82062307704528 | 5297835 | 13.359556503379  | 30860049       | 77.8198204195758 | 96.9054974604869 | 27515736            | 89.16              | 10767                 | 1.14585                    | 92.3259       | 28058778        |
| 14 | SRR18280836 | 19424028    | 17698608              | 8.88291553121731 | 3801379 | 19.5704979420334 | 13897229       | 71.5465865267492 | 97.0233274561425 | 12383754            | 89.11              | 8376                  | 1.011                      | 93.0258       | 12715937        |
| 15 | SRR18280837 | 29996107    | 27326779              | 8.89891478250828 | 4270411 | 14.2365507630707 | 23056368       | 76.864534454421  | 71.208999613469  | 15243128            | 66.11              | 12801                 | 1.0925                     | 76.8869       | 12869278        |
| 16 | SRR18280838 | 26482290    | 24009287              | 9.33832761441703 | 3826224 | 14.4482369160673 | 20183063       | 76.2134354695157 | 97.5428407472146 | 18423483            | 91.28              | 12730                 | 0.788371                   | 84.46         | 16898032        |
| 17 | SRR18280839 | 34727216    | 32232894              | 7.182614350658   | 3551336 | 10.2263769142911 | 28681558       | 82.5910087350509 | 97.5737196703192 | 25878271            | 90.23              | 17943                 | 1.88778                    | 51.0535       | 14525939        |
| 18 | SRR18280840 | 32115497    | 29810920              | 7.17590327186903 | 4217704 | 13.1329245815501 | 25593216       | 79.6911721465808 | 97.6332321815281 | 23334104            | 91.17              | 17546                 | 1.67966                    | 36.0656       | 9182422         |
| 19 | SRR18280841 | 30488876    | 28370667              | 6.94748143552422 | 3958048 | 12.981941348051  | 24412619       | 80.0705772164248 | 97.4154964692645 | 22116347            | 90.59              | 17635                 | 1.7375                     | 32.0841       | 7806591         |
| 20 | SRR18280842 | 28011430    | 26086816              | 6.87081666305505 | 3351722 | 11.9655512053472 | 22735094       | 81.1636321315977 | 97.2158241351454 | 20594230            | 90.58              | 17791                 | 1.94068                    | 32.5155       | 7383511         |
| 21 | SRR18280843 | 20818677    | 19085006              | 8.32747921493763 | 3192085 | 15.3327946823902 | 15892921       | 76.3397261026721 | 96.914588576889  | 14448744            | 90.91              | 17006                 | 1.22697                    | 26.9283       | 4286634         |
| 22 | SRR18280844 | 30269656    | 28115996              | 7.11491402479103 | 3525344 | 11.6464620542764 | 24590652       | 81.2386239209326 | 96.8081814178819 | 22457818            | 91.33              | 18531                 | 1.24213                    | 24.5419       | 6036716         |
| 23 | SRR18280845 | 25055623    | 23140780              | 7.6423683418289  | 3298669 | 13.1653840736668 | 19842111       | 79.1922475845043 | 97.6932696324499 | 18202976            | 91.74              | 17503                 | 1.35345                    | 30.291        | 6000334         |
| 24 | SRR18280846 | 23670006    | 21433296              | 9.44955400518276 | 3279281 | 13.8541620986492 | 18154015       | 76.696283896168  | 97.5303259361634 | 16415716            | 90.42              | 11834                 | 0.601825                   | 86.4071       | 15512288        |
| 25 | SRR18280847 | 14923102    | 13571861              | 9.05469251634144 | 4009618 | 26.8685290765955 | 9562243        | 64.0767784070631 | 96.3043921807885 | 8258129             | 86.36              | 11177                 | 1.67379                    | 82.2241       | 7708730         |
| 26 | SRR18280848 | 16833497    | 15511768              | 7.85177910448435 | 2796383 | 16.6120147227875 | 12715385       | 75.5362061727281 | 97.4621688607934 | 11698903            | 92.01              | 16043                 | 1.37181                    | 31.0635       | 3940926         |
| 27 | SRR18280849 | 23134096    | 21465911              | 7.21093661926535 | 2414537 | 10.4371357324704 | 19051374       | 82.3519276482643 | 97.0377569617813 | 17390599            | 91.28              | 16339                 | 1.94988                    | 33.1105       | 6282896         |
| 28 | SRR18280850 | 16684909    | 15378078              | 7.83241311055397 | 2833578 | 16.9828795590075 | 12544500       | 75.1847073304385 | 97.3366814141656 | 11426288            | 91.09              | 15827                 | 1.87982                    | 30.5937       | 3830294         |
| 29 | SRR18280851 | 26417241    | 24622235              | 6.7948276657657  | 2281020 | 8.63458829784685 | 22341215       | 84.5705840363874 | 97.993300722454  | 20771002            | 92.97              | 18146                 | 1.16665                    | 26.2571       | 5861864         |
| 30 | SRR18280852 | 32301698    | 29423142              | 8.91146960757295 | 4403925 | 13.6337260041252 | 25019217       | 77.4548043883018 | 96.6522413551152 | 22422800            | 89.62              | 12943                 | 0.770676                   | 86.4285       | 21189599        |
| 31 | SRR18280853 | 55476143    | 50961712              | 8.13760790832196 | 5427625 | 9.78371008957851 | 45534087       | 82.0786820020995 | 96.6977069288773 | 40980809            | 90                 | 13578                 | 1.159                      | 90.795        | 40865950        |
| 32 | SRR18280854 | 33088472    | 30208576              | 8.70362342510104 | 4954171 | 14.9724985789613 | 25254405       | 76.3238779959377 | 96.8682097242045 | 22697518            | 89.88              | 12202                 | 1.02417                    | 88.5895       | 21987217        |
| 33 | SRR18280855 | 31148156    | 28481066              | 8.56259356091577 | 3985547 | 12.795450876771  | 24495519       | 78.6419555623132 | 97.2383561254612 | 22299528            | 91.04              | 12267                 | 0.739968                   | 85.7626       | 20740968        |
| 34 | SRR18280856 | 23014798    | 21084478              | 8.38729933671371 | 3483342 | 15.135227343729  | 17601136       | 76.4774733195573 | 95.7293097445529 | 15658928            | 88.97              | 9026                  | 1.27033                    | 94.6566       | 16300882        |
